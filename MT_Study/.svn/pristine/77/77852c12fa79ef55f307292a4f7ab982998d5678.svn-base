package alarms;

import com.example.mt_study.R;

import android.app.Activity;
import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.content.Intent;
import android.media.AudioManager;
import android.media.Ringtone;
import android.media.RingtoneManager;
import android.net.Uri;
import android.os.Bundle;
import android.widget.Toast;


public class DisplayNotification extends Activity {
	@Override
	public void onCreate(Bundle SavedInstanceState) {
		super.onCreate(SavedInstanceState);
		
		int notifID = getIntent().getExtras().getInt("NotificationId");
		String name = getIntent().getExtras().getString("assignmentName");
		boolean vibrate = getIntent().getExtras().getBoolean("Vibrate");
		int vibrateType = getIntent().getExtras().getInt("vibrateType");
		boolean musix = getIntent().getExtras().getBoolean("Musix");
		String musixType = getIntent().getExtras().getString("MusixType");
		
		Intent i = new Intent(this, com.example.mt_study.Main_screen.class);
		i.putExtra("NotificationId", notifID);
		
		PendingIntent displayAlarm = PendingIntent.getActivity(this, 0, i, 0);
		
		NotificationManager nm = (NotificationManager)
	            getSystemService(NOTIFICATION_SERVICE);
	        Notification notif = new Notification(
	            R.drawable.book, 
	            "Time's up!",
	            System.currentTimeMillis());
	 
	        CharSequence from = name;
	        CharSequence message = "This assignment is due soon!";        
	        notif.setLatestEventInfo(this, from, message, displayAlarm);
	 
	        if (musix) {
	        	Ringtone song = RingtoneManager.getRingtone(DisplayNotification.this, Uri.parse(musixType));
	        	song.play();
	        	song.setStreamType(AudioManager.STREAM_ALARM);
	        }
	        
	        
	        //---100ms delay, vibrate for 250ms, pause for 100 ms and
	        // then vibrate for 500ms---
	        if (vibrate) {
	        	switch(vibrateType) {
	        	case 0:
		        	notif.vibrate = new long[] { 100, 250, 100, 500};
		        	break;
	        	case 1:
	        		notif.vibrate = new long[] { 100, 400, 100, 500};
	        		break;
	        	case 2:
	        		notif.vibrate = new long[] {100, 200, 100, 200, 150, 400};
	        		break;
	        	case 3:
	        		notif.vibrate = new long[] {50, 100, 50, 150, 50, 200};
	        		break;
	        	case 4:
	        		notif.vibrate = new long[] {100, 700};
	        		break;
	        	case 5:
	        		notif.vibrate = new long[] {5000, 10000};
	        		break;
	        	default:
	        		notif.vibrate = new long[] {500, 10000};	        	}
	        }
        	nm.notify(notifID, notif);
	        //---destroy the activity---
	        finish();
	}

}